<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head('auth.login.title')}"></head>
<body class="container mt-5" style="max-width: 520px;">

<h1 class="mb-4" th:text="#{auth.login.title}">Login</h1>

<div th:if="${param.error}" class="alert alert-danger">

    <span th:if="${param.error[0] == 'disabled'}" th:text="#{auth.error.disabled}">
        Account is disabled. Contact administrator.
    </span>

    <span th:if="${param.error[0] == 'locked'}" th:text="#{auth.error.locked}">
        Account is locked. Try again later.
    </span>

    <span th:if="${param.error[0] == 'bad'}" th:text="#{auth.error.bad}">
        Bad credentials.
    </span>

    <span th:if="${param.error[0] != 'disabled' and param.error[0] != 'locked' and param.error[0] != 'bad'}"
          th:text="#{auth.error.bad}">
        Bad credentials.
    </span>

</div>

<div th:if="${param.logout}" class="alert alert-success" th:text="#{auth.logout.success}">
    Logged out successfully
</div>

<div th:if="${success}" class="alert alert-success" th:text="${success}"></div>

<form th:action="@{/login}" method="post" class="mt-3">

    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

    <div class="mb-3">
        <label class="form-label" th:text="#{object.user.email}">Email</label>
        <input name="username" type="text" class="form-control" required th:value="${lastUsername}">
    </div>

    <div class="mb-3">
        <label class="form-label" th:text="#{object.user.password}">Password</label>
        <input name="password" type="password" class="form-control" required>
    </div>

    <div class="form-check mb-3">
        <input class="form-check-input" type="checkbox" name="remember-me" id="remember-me">
        <label class="form-check-label" for="remember-me" th:text="#{auth.rememberMe}">Remember me</label>
    </div>

    <div class="d-flex gap-2">
        <button class="btn btn-primary" type="submit" th:text="#{auth.signIn}">Sign in</button>

        <a th:href="@{/catalog(lang=${#locale.language})}" class="btn btn-outline-secondary ms-auto"
           th:text="#{catalog.back}">
            Back to catalog
        </a>
    </div>

    <div th:if="${param.locked}" class="alert alert-danger mt-3" th:text="#{auth.tooManyAttempts}">
        Too many attempts. Please try later.
    </div>

</form>

<hr class="my-4">
<div class="d-grid gap-2 mt-3">
    <a class="btn btn-outline-dark"
       th:href="@{/oauth2/authorization/google}">
        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"
             alt="Google" style="height:18px; margin-right:8px;">
        Sign in with Google
    </a>
</div>

<div class="text-center text-muted">
    <span th:text="#{auth.noAccount}">Donâ€™t have an account?</span>
    <a th:href="@{/register(lang=${#locale.language})}" th:text="#{auth.createOne}">Create one</a>
</div>

</body>
</html>
