<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head(${mode == 'edit' ? 'appliance.edit.title' : 'appliance.new.title'})}"></head>
<body>

<div th:insert="~{menunavy::navy}"></div>

<div class="container mt-4" style="max-width: 980px;">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="mb-0" th:text="${mode == 'edit'} ? #{appliance.edit.title} : #{appliance.new.title}">
            Appliance
        </h1>
        <a class="btn btn-outline-secondary"
           th:href="@{/admin/appliances(lang=${#locale.language})}"
           th:text="#{back}">Back</a>
    </div>

    <div class="card shadow-sm">
        <div class="card-body">

            <form th:object="${appliance}"
                  th:with="isEdit=${mode == 'edit'}"
                  th:action="${isEdit} ? @{/admin/appliances/{id}(id=${appliance.id},lang=${#locale.language})} : @{/admin/appliances(lang=${#locale.language})}"
                  method="post"
                  class="row g-3">

                <input type="hidden" th:field="*{id}"/>

                <div class="col-12" th:if="${#fields.hasAnyErrors()}">
                    <div class="alert alert-danger mb-0">
                        <div class="fw-semibold mb-1" th:text="#{form.fix.errors}">
                            Please fix the errors below:
                        </div>
                        <div th:errors="*{*}">Error</div>
                    </div>
                </div>

                <div class="col-md-6">
                    <label class="form-label" for="name" th:text="#{object.appliance.name}">Name</label>
                    <input id="name" type="text"
                           class="form-control"
                           th:field="*{name}"
                           th:classappend="${#fields.hasErrors('name')} ? ' is-invalid' : ''"
                           placeholder="Appliance name">
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('name')}" th:errors="*{name}">error</div>
                </div>

                <div class="col-md-6">
                    <label class="form-label" for="model" th:text="#{object.appliance.model}">Model</label>
                    <input id="model" type="text"
                           class="form-control"
                           th:field="*{model}"
                           th:classappend="${#fields.hasErrors('model')} ? ' is-invalid' : ''"
                           placeholder="Model">
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('model')}" th:errors="*{model}">error</div>
                </div>

                <div class="col-md-6">
                    <label class="form-label" for="manufacturerId" th:text="#{object.appliance.manufacturer}">Manufacturer</label>
                    <select id="manufacturerId"
                            class="form-select"
                            th:field="*{manufacturerId}"
                            th:classappend="${#fields.hasErrors('manufacturerId')} ? ' is-invalid' : ''">
                        <option value="" disabled th:selected="*{manufacturerId} == null" th:text="#{select.manufacturer}">
                            Select manufacturer
                        </option>
                        <option th:each="m : ${manufacturers}"
                                th:value="${m.id}"
                                th:text="${m.name}">
                        </option>
                    </select>
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('manufacturerId')}" th:errors="*{manufacturerId}">
                        error
                    </div>
                </div>

                <div class="col-md-6">
                    <label class="form-label" for="category" th:text="#{object.appliance.category}">Category</label>
                    <select id="category"
                            class="form-select"
                            th:field="*{category}"
                            th:classappend="${#fields.hasErrors('category')} ? ' is-invalid' : ''">
                        <option value="" disabled th:selected="*{category} == null" th:text="#{select.category}">
                            Select category
                        </option>
                        <option th:each="c : ${categories}"
                                th:value="${c}"
                                th:text="${c}">
                        </option>
                    </select>
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('category')}" th:errors="*{category}">
                        error
                    </div>
                </div>

                <div class="col-md-6">
                    <label class="form-label" for="powerType" th:text="#{object.appliance.powerType}">Power type</label>
                    <select id="powerType"
                            class="form-select"
                            th:field="*{powerType}"
                            th:classappend="${#fields.hasErrors('powerType')} ? ' is-invalid' : ''">
                        <option value="" disabled th:selected="*{powerType} == null" th:text="#{select.powerType}">
                            Select power type
                        </option>
                        <option th:each="p : ${powerTypes}"
                                th:value="${p}"
                                th:text="${p}">
                        </option>
                    </select>
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('powerType')}" th:errors="*{powerType}">
                        error
                    </div>
                </div>

                <div class="col-md-6">
                    <label class="form-label" for="power" th:text="#{object.appliance.power}">Power</label>
                    <input id="power" type="number" min="1"
                           class="form-control"
                           th:field="*{power}"
                           th:classappend="${#fields.hasErrors('power')} ? ' is-invalid' : ''"
                           placeholder="Power">
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('power')}" th:errors="*{power}">
                        error
                    </div>
                </div>

                <div class="col-md-6">
                    <label class="form-label" for="price" th:text="#{object.appliance.price}">Price</label>
                    <input id="price" type="number" step="0.01" min="0"
                           class="form-control"
                           th:field="*{price}"
                           th:classappend="${#fields.hasErrors('price')} ? ' is-invalid' : ''">
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('price')}" th:errors="*{price}">
                        error
                    </div>
                </div>

                <div class="col-12">
                    <label class="form-label" for="characteristic" th:text="#{object.appliance.characteristic}">Characteristic</label>
                    <input id="characteristic" type="text"
                           class="form-control"
                           th:field="*{characteristic}"
                           th:classappend="${#fields.hasErrors('characteristic')} ? ' is-invalid' : ''"
                           placeholder="Characteristic">
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('characteristic')}" th:errors="*{characteristic}">
                        error
                    </div>
                </div>

                <div class="col-12">
                    <label class="form-label" for="description" th:text="#{object.appliance.description}">Description</label>
                    <textarea id="description" class="form-control" rows="4"
                              th:field="*{description}"
                              th:classappend="${#fields.hasErrors('description')} ? ' is-invalid' : ''"
                              placeholder="Description"></textarea>
                    <div class="invalid-feedback" th:if="${#fields.hasErrors('description')}" th:errors="*{description}">
                        error
                    </div>
                </div>

                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                <div class="col-12 d-flex gap-2">
                    <button class="btn btn-success" type="submit"
                            th:text="${mode == 'edit'} ? #{save} : #{create}">
                        Create
                    </button>
                    <a class="btn btn-outline-secondary"
                       th:href="@{/admin/appliances(lang=${#locale.language})}"
                       th:text="#{cancel}">
                        Cancel
                    </a>
                </div>

            </form>
        </div>
    </div>
</div>

<div th:insert="~{footer::footer}"></div>

</body>
</html>
